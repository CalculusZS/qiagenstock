<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Main - QIAGEN Inventory</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body { font-family: sans-serif; margin: 0; background: #f8fafc; }
        .header { background: #003366; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; }
        .container { max-width: 600px; margin: auto; padding: 15px; }
        .mode-box { display: flex; gap: 10px; margin-bottom: 15px; }
        .btn-m { flex: 1; padding: 12px; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; background: white; color: #64748b; border: 1px solid #ddd; transition: 0.2s; }
        .active-w { background: #003366 !important; color: white !important; }
        .active-r { background: #16a34a !important; color: white !important; }
        .search { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 15px; box-sizing: border-box; font-size: 16px; outline: none; }
        .search:focus { border-color: #003366; }
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        th { background: #f1f5f9; padding: 12px; text-align: left; font-size: 12px; color: #64748b; text-transform: uppercase; }
        td { padding: 12px; border-bottom: 1px solid #f1f5f9; }
        .btn-action { padding: 8px 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; background: #003366; color: white; }
        .qty-input-sm { width: 50px; padding: 8px; border: 1px solid #ddd; border-radius: 6px; text-align: center; margin-right: 5px; }
        .badge { padding: 4px 8px; border-radius: 6px; font-weight: bold; background: #e2e8f0; color: #003366; }
    </style>
</head>
<body onload="init()">
    <div class="header">
        <b>QIAGEN: <span id="user_display">Loading...</span></b>
        <div style="display: flex; gap: 10px;">
            <button onclick="location.href='history.html'" style="background:rgba(255,255,255,0.2);color:white;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;">History</button>
            <button onclick="logout()" style="background:#ef4444;color:white;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;">Logout</button>
        </div>
    </div>

    <div class="container">
        <div class="mode-box">
            <button id="bw" class="btn-m active-w" onclick="changeMode('withdraw')">üì• Withdraw</button>
            <button id="br" class="btn-m" onclick="changeMode('return')">üì§ Return</button>
        </div>

        <input type="text" class="search" placeholder="Search Material or Product Name..." oninput="window.searchStock(this.value, currentMode)">

        <table>
            <thead>
                <tr>
                    <th>Items</th>
                    <th style="text-align:center">Stock</th>
                    <th style="text-align:right">Action</th>
                </tr>
            </thead>
            <tbody id="data">
                <tr><td colspan="3" align="center">‚åõ Loading Inventory...</td></tr>
            </tbody>
        </table>
    </div>

    <script src="js/app.js"></script>
    <script>
        let currentMode = 'withdraw';

        function init() {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö
            if (!window.checkAuth()) return;
            
            const u = sessionStorage.getItem('selectedUser');
            document.getElementById('user_display').innerText = u;
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ï‡πá‡∏≠‡∏Å
            window.loadStockData('withdraw');
        }

        function changeMode(m) {
            currentMode = m;
            document.getElementById('bw').className = (m === 'withdraw' ? 'btn-m active-w' : 'btn-m');
            document.getElementById('br').className = (m === 'return' ? 'btn-m active-r' : 'btn-m');
            window.loadStockData(m);
        }
    </script>
</body>
</html>
