<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qiagen Stock - ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ö‡∏¥‡∏Å‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ main */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background-color: #f8fafc; }
        .header { background: #1e293b; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .container { max-width: 900px; margin: 20px auto; padding: 0 15px; }
        .user-card { display: flex; justify-content: space-between; align-items: center; background: white; padding: 15px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .mode-selector { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn-mode { flex: 1; padding: 15px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 16px; }
        .search-input { width: 100%; padding: 15px; border-radius: 10px; border: 1px solid #cbd5e1; margin-bottom: 20px; box-sizing: border-box; font-size: 16px; outline: none; }
        .search-input:focus { border-color: #2563eb; ring: 2px solid #bfdbfe; }
        .stock-table { width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .stock-table th { background: #f1f5f9; padding: 12px; text-align: left; color: #64748b; font-size: 14px; }
        .view-all-btn { width: 100%; padding: 12px; background: #64748b; color: white; border: none; border-radius: 10px; margin-bottom: 20px; cursor: pointer; font-weight: bold; }
        .view-all-btn:hover { background: #475569; }
    </style>
</head>
<body onload="initMain()">

    <div class="header">
        <div style="font-weight: bold; font-size: 18px;">üß¨ QIAGEN STOCK</div>
        <button onclick="logout()" style="background: #ef4444; border: none; color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>

    <div class="container">
        <div class="user-card">
            <div>‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: <strong id="user_display" style="color: #2563eb; font-size: 18px;">-</strong></div>
            <button onclick="goBack()" style="background: #f1f5f9; border: 1px solid #cbd5e1; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 14px;">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏ö‡∏¥‡∏Å</button>
        </div>

        <div class="mode-selector">
            <button id="t-withdraw" class="btn-mode" onclick="setMode('withdraw')">üì§ ‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà (OUT)</button>
            <button id="t-return" class="btn-mode" onclick="setMode('return')">üì• ‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà (IN)</button>
        </div>

        <button class="view-all-btn" onclick="location.href='showall.html'">üì¶ ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (View All Parts)</button>

        <input type="text" id="searchInput" class="search-input" placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤..." oninput="searchStock(this.value, currentMode)">

        <table class="stock-table">
            <thead>
                <tr>
                    <th style="width: 55%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</th>
                    <th style="text-align: center; width: 15%;">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
                    <th style="text-align: right; width: 30%; padding-right: 20px;">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
            </thead>
            <tbody id="data">
                </tbody>
        </table>
    </div>

    <script src="js/app.js"></script>
    
    <script>
        let currentMode = 'withdraw';

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤
        async function initMain() {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Login
            if (sessionStorage.getItem('isLoggedIn') !== 'true') {
                location.href = 'index.html';
                return;
            }

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
            const selectedUser = sessionStorage.getItem('selectedUser');
            if (!selectedUser) {
                location.href = 'user-select.html';
                return;
            }
            document.getElementById('user_display').textContent = selectedUser;

            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡πÇ‡∏´‡∏°‡∏î‡πÄ‡∏ö‡∏¥‡∏Å)
            await setMode('withdraw');
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏´‡∏°‡∏î (‡πÄ‡∏ö‡∏¥‡∏Å/‡∏Ñ‡∏∑‡∏ô)
        async function setMode(mode) {
            currentMode = mode;
            
            // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏´‡∏°‡∏î
            document.getElementById('searchInput').value = '';

            // ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π
            const btnWithdraw = document.getElementById('t-withdraw');
            const btnReturn = document.getElementById('t-return');

            if (mode === 'withdraw') {
                btnWithdraw.style.background = '#2563eb';
                btnWithdraw.style.color = 'white';
                btnReturn.style.background = '#e2e8f0';
                btnReturn.style.color = '#475569';
            } else {
                btnWithdraw.style.background = '#e2e8f0';
                btnWithdraw.style.color = '#475569';
                btnReturn.style.background = '#22c55e';
                btnReturn.style.color = 'white';
            }

            // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÉ‡∏ä‡πâ await ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô)
            await window.loadStockData(mode);
        }
    </script>
</body>
</html>
