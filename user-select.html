<script src="js/app.js"></script>
<script>
  (async function init() {
    const grid = document.getElementById('userGrid');
    grid.innerHTML = '<p>กำลังโหลดรายชื่อ...</p>';
    
    // เรียกฟังก์ชันจาก app.js
    const users = await loadUsers(); 
    
    if (!users || users.length === 0) {
      grid.innerHTML = '<p style="color:red;">ไม่พบรายชื่อ! ตรวจสอบหัวคอลัมน์ใน Excel</p>';
      return;
    }

    grid.innerHTML = users.map(name => {
      // ตรวจสอบว่ามี user เดิมที่เลือกไว้หรือไม่
      const isActive = (sessionStorage.getItem('selectedUser') === name) ? ' is-active' : '';
      return `<button class="user-btn${isActive}" data-user="${name}">${name}</button>`;
    }).join('');

    // ใส่ Event ให้ปุ่ม
    grid.addEventListener('click', (e) => {
      const btn = e.target.closest('.user-btn');
      if (!btn) return;
      document.querySelectorAll('.user-btn').forEach(b => b.classList.remove('is-active'));
      btn.classList.add('is-active');
      sessionStorage.setItem('selectedUser', btn.getAttribute('data-user'));
    });
  })();
</script>
